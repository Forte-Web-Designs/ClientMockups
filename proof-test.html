<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prove It Works - Live Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-console { 
            background: #000; 
            color: #00ff00; 
            padding: 20px; 
            border-radius: 8px; 
            height: 300px; 
            overflow-y: auto; 
            font-family: monospace;
            margin: 20px 0;
        }
        .test-buttons {
            text-align: center;
            margin: 20px 0;
        }
        .test-buttons button {
            background: #007bff;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            margin: 10px;
            cursor: pointer;
            font-size: 16px;
        }
        .test-buttons button:hover {
            background: #0056b3;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>üß™ LIVE PROOF TEST: Does the Generator Actually Work?</h1>
    
    <div class="test-buttons">
        <button onclick="testQuickDemo()">üéØ Test Quick Demo</button>
        <button onclick="testGenerate()">‚ö° Test Generate Mockup</button>
        <button onclick="checkStatus()">üîç Check System Status</button>
    </div>
    
    <div class="test-console" id="console"></div>
    
    <h2>Main Page (Live):</h2>
    <iframe id="mainPage" src="/index.html"></iframe>
    
    <script>
        const console_el = document.getElementById('console');
        
        function log(message, color = '#00ff00') {
            const time = new Date().toLocaleTimeString();
            console_el.innerHTML += `<div style="color: ${color};">[${time}] ${message}</div>`;
            console_el.scrollTop = console_el.scrollHeight;
            console.log(message);
        }
        
        function getMainPageWindow() {
            const iframe = document.getElementById('mainPage');
            return iframe.contentWindow;
        }
        
        function getMainPageDoc() {
            const iframe = document.getElementById('mainPage');
            return iframe.contentDocument || iframe.contentWindow.document;
        }
        
        window.onload = function() {
            log('üöÄ Starting live proof test...', '#ffff00');
            log('üìã Loading main page and waiting for initialization...');
            
            setTimeout(() => {
                checkStatus();
            }, 3000);
        };
        
        function checkStatus() {
            log('üîç CHECKING SYSTEM STATUS...', '#00ffff');
            
            try {
                const mainWin = getMainPageWindow();
                const mainDoc = getMainPageDoc();
                
                // Check if MockupGenerator class exists
                if (typeof mainWin.MockupGenerator !== 'undefined') {
                    log('‚úÖ MockupGenerator class found', '#00ff00');
                } else {
                    log('‚ùå MockupGenerator class NOT found', '#ff4444');
                    return;
                }
                
                // Check if generator instance exists
                if (mainWin.generator) {
                    log('‚úÖ Generator instance found', '#00ff00');
                } else {
                    log('‚ùå Generator instance NOT found', '#ff4444');
                    return;
                }
                
                // Check required methods
                const methods = ['fillDemoData', 'generateMockup', 'displayPreview'];
                methods.forEach(method => {
                    if (typeof mainWin.generator[method] === 'function') {
                        log(`‚úÖ Method ${method} exists`, '#00ff00');
                    } else {
                        log(`‚ùå Method ${method} MISSING`, '#ff4444');
                    }
                });
                
                // Check buttons
                const demoBtn = mainDoc.getElementById('demoBtn');
                const form = mainDoc.getElementById('mockupForm');
                
                if (demoBtn) {
                    log('‚úÖ Quick Demo button found', '#00ff00');
                } else {
                    log('‚ùå Quick Demo button NOT found', '#ff4444');
                }
                
                if (form) {
                    log('‚úÖ Mockup form found', '#00ff00');
                } else {
                    log('‚ùå Mockup form NOT found', '#ff4444');
                }
                
                log('üìä System status check complete!', '#ffff00');
                
            } catch (error) {
                log('‚ùå Error checking status: ' + error.message, '#ff4444');
            }
        }
        
        function testQuickDemo() {
            log('üéØ TESTING QUICK DEMO...', '#ffff00');
            
            try {
                const mainWin = getMainPageWindow();
                const mainDoc = getMainPageDoc();
                
                if (!mainWin.generator) {
                    log('‚ùå No generator instance found', '#ff4444');
                    return;
                }
                
                // Check form before
                const companyName = mainDoc.getElementById('companyName');
                const phoneNumber = mainDoc.getElementById('phoneNumber');
                
                if (companyName) {
                    log(`üìã Before - Company: "${companyName.value}"`, '#888888');
                } else {
                    log('‚ùå Company name field not found', '#ff4444');
                    return;
                }
                
                // Click the actual button
                const demoBtn = mainDoc.getElementById('demoBtn');
                if (demoBtn) {
                    log('üñ±Ô∏è Clicking Quick Demo button...', '#00ffff');
                    demoBtn.click();
                    
                    // Check form after
                    setTimeout(() => {
                        if (companyName.value) {
                            log(`‚úÖ SUCCESS! Company filled: "${companyName.value}"`, '#00ff00');
                            if (phoneNumber && phoneNumber.value) {
                                log(`‚úÖ Phone filled: "${phoneNumber.value}"`, '#00ff00');
                            }
                            log('üéâ QUICK DEMO WORKS!', '#00ff88');
                        } else {
                            log('‚ùå FAILED! Form not filled', '#ff4444');
                        }
                    }, 1000);
                    
                } else {
                    log('‚ùå Demo button not found', '#ff4444');
                }
                
            } catch (error) {
                log('‚ùå Error testing quick demo: ' + error.message, '#ff4444');
            }
        }
        
        function testGenerate() {
            log('‚ö° TESTING GENERATE MOCKUP...', '#ffff00');
            
            try {
                const mainWin = getMainPageWindow();
                const mainDoc = getMainPageDoc();
                
                if (!mainWin.generator) {
                    log('‚ùå No generator instance found', '#ff4444');
                    return;
                }
                
                // Fill form with test data
                const companyName = mainDoc.getElementById('companyName');
                const phoneNumber = mainDoc.getElementById('phoneNumber');
                const serviceType = mainDoc.getElementById('serviceType');
                
                if (companyName) companyName.value = 'LIVE TEST PLUMBING';
                if (phoneNumber) phoneNumber.value = '555-WORKS';
                if (serviceType) serviceType.value = 'plumbing';
                
                log('üìù Test data filled', '#00ffff');
                
                // Check preview section before
                const previewSection = mainDoc.getElementById('previewSection');
                if (previewSection) {
                    log(`üìã Before - Preview visible: ${previewSection.style.display !== 'none'}`, '#888888');
                } else {
                    log('‚ùå Preview section not found', '#ff4444');
                    return;
                }
                
                // Submit the form (this should trigger generate)
                const form = mainDoc.getElementById('mockupForm');
                if (form) {
                    log('üñ±Ô∏è Submitting form to generate mockup...', '#00ffff');
                    form.dispatchEvent(new Event('submit'));
                    
                    // Check if preview appears
                    setTimeout(() => {
                        if (previewSection.style.display !== 'none') {
                            log('‚úÖ SUCCESS! Preview section appeared!', '#00ff00');
                            
                            const previewFrame = mainDoc.getElementById('previewFrame');
                            if (previewFrame && previewFrame.srcdoc) {
                                log('‚úÖ Preview content loaded!', '#00ff00');
                                log('üìÑ Content preview: ' + previewFrame.srcdoc.substring(0, 100) + '...', '#888888');
                                log('üéâ GENERATE MOCKUP WORKS!', '#00ff88');
                            } else {
                                log('‚ö†Ô∏è Preview visible but no content', '#ffaa00');
                            }
                        } else {
                            log('‚ùå FAILED! Preview section did not appear', '#ff4444');
                        }
                    }, 2000);
                    
                } else {
                    log('‚ùå Form not found', '#ff4444');
                }
                
            } catch (error) {
                log('‚ùå Error testing generate: ' + error.message, '#ff4444');
            }
        }
    </script>
</body>
</html>
